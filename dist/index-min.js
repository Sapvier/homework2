class FormValidator{constructor(e,t){this.form=e,this.fields=t}initialize(){this.validateOnSubmit(),this.validateOnEntry(),this.unlockButton(),this.showPassword(),this.validateName(),this.validatePassword(),this.validateSelect(),this.validateOnKeyDown()}validateOnSubmit(){let e=document.querySelector(".submit-button");this.form.addEventListener("submit",t=>{t.preventDefault(),this.fields.forEach(t=>{const a=document.querySelector(`#${t}`);if(a.value=a.value.trim(),"password"===t)var i=this.validatePassword(a);else if("name"===t)var s=this.validateName(a);else var l=this.validateSelect(a);i||s||l?(e.style.animation="submitInvalid 1s",e.style.animationPlayState="running"):(e.style.animation="submitValid 1s",e.style.animationPlayState="running")})})}validateOnKeyDown(){this.form.onkeydown=(()=>this.validateOnSubmit())}validateOnEntry(){this.fields.forEach(e=>{const t=document.querySelector(`#${e}`);t.addEventListener("input",()=>{"password"===t.id?this.validatePassword(t):this.validateName(t)}),t.addEventListener("change",()=>{this.validateSelect(t)})})}validatePassword(e){let t=e.parentElement,a=e.parentElement.nextSibling,i=!1,s=/^(?=.*?[A-Z])(?=.*?[a-z])(?=.*?[0-9])(?=.*?[^\w\s]).{8,}$/;return e.value.length<1?(t.classList.add("with-errors"),a.innerHTML="Required field",e.focus(),i=!0):"password"!==e.id||s.test(e.value)?"password"===e.id&&s.test(e.value)?(a.innerHTML="",t.classList.remove("with-errors"),i):void 0:(a.innerHTML="Password must contain at least 8 characters, including uppercase, lowercase letter and a number.",t.classList.add("with-errors"),e.focus(),i=!0)}validateName(e){e.value=e.value.trimStart().replace(/\s{2,}/g," "),e.value=e.value.replace(/[^a-zA-ZА-я\s0-9]/g,"");let t=e.parentElement,a=e.parentElement.nextSibling,i=!1;return e.value.length<1?(t.classList.add("with-errors"),a.innerHTML="Required field",i=!0,e.focus(),i):e.value.length>0&&"name"===e.id?(t.classList.remove("with-errors"),a.innerHTML="",i):void 0}validateSelect(e){let t=e.parentElement.nextSibling,a=!1;return"country"===e.value?(t.innerHTML="Required field",e.classList.add("with-errors"),a=!0):(e.classList.remove("with-errors"),t.innerHTML="",document.querySelector(".submit-button").focus(),a)}unlockButton(){let e=document.getElementById("terms"),t=document.querySelector(".submit-button");e.addEventListener("change",()=>{e.checked?(t.disabled=!1,t.classList.add("active")):(t.disabled=!0,t.style.backgroundColor="silver")})}showPassword(){let e=document.getElementById("eye"),t=document.getElementById("eye-slashed"),a=document.getElementById("password");e.addEventListener("click",()=>{a.attributes.type.value="text",e.style.display="none",t.style.display="block"}),t.addEventListener("click",()=>{a.attributes.type.value="password",e.style.display="block",t.style.display="none"})}}const form=document.querySelector("#form"),fields=["name","password","countries"],validator=new FormValidator(form,fields);validator.initialize();